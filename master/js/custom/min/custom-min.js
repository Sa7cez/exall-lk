!function(e,a,$,t){$(function(){function n(e,a){return a?e.toFixed(a).replace(/\.?0+$/,""):e.toFixed(a)}var o={RUB:"1",CNY:"1",ZAR:"1",RON:"1",USD:"1",EUR:"1",JPR:"1",DKK:"1"},s="jq-appCurInfo",i=$.localStorage.get(s)||o;$.localStorage.set(s,i),$.each(i,function(e,a){1==a?($("#"+e+"_info").show(),$('.chooser_popup input[value="'+e+'"]').prop("checked",!0)):($("#"+e+"_info").hide(),$('.chooser_popup input[value="'+e+'"]').prop("checked",!1))}),$(a).on("change",".chooser_popup input",function(){var e=$.localStorage.get(s)||o;$(this).is(":checked")?(e[$(this).val()]="1",$.localStorage.set(s,e),$("#"+$(this).val()+"_info").show()):(e[$(this).val()]="0",$.localStorage.set(s,e),$("#"+$(this).val()+"_info").hide())}),$(".currencies ul li").on({mouseenter:function(){$(".currencies ul li.open").removeClass("open"),$(this).addClass("open")},mouseleave:function(){}}),$(".topnavbar .wallet-opener").on({mouseenter:function(){$(".topnavbar .open").removeClass("open"),$(this).addClass("open")},mouseleave:function(){$(this).removeClass("open")}}),$(e).resize(function(){$(".favorite-selector, .payment-selector").select2({})}),$.easing.jswing=$.easing.swing,$.extend($.easing,{easeInOutBack:function(e,a,n,o,s,i){return i===t&&(i=1.70158),(a/=s/2)<1?o/2*(a*a*(((i*=1.525)+1)*a-i))+n:o/2*((a-=2)*a*(((i*=1.525)+1)*a+i)+2)+n}}),$.fn.animatescroll=function(e){var a=$.extend({},$.fn.animatescroll.defaults,e);if("html,body"===a.element){if(this.hasClass("no_padding"))var t=this.offset().top-50;else var t=this.offset().top-70;var n=0;$(a.element).stop().animate({scrollTop:t-(a.padding+n)},a.scrollSpeed,a.easing)}else $(a.element).stop().animate({scrollTop:this.offset().top-this.parent().offset().top+this.parent().scrollTop()-a.padding},a.scrollSpeed,a.easing)},$.fn.animatescroll.defaults={easing:"swing",scrollSpeed:500,padding:0,element:"html,body"};var l=150;$(".buysell_popup").slideUp(1),$(a).on("click","#buysell tbody [role=row]",function(){position=$(this).position().top+47,row_id=$(this).attr("id"),$(".buysell_popup").slideUp(l),"1"!=$("#"+row_id+"-popup").length?($(".buysell_popup.template").clone().removeClass("template").appendTo("#buysell .tab-content").attr("id",row_id+"-popup"),$("#"+row_id+"-popup").css("top",position).addClass("opened").slideDown(l)):$("#"+row_id+"-popup").hasClass("opened")?$("#"+row_id+"-popup").css("top",position).removeClass("opened").slideUp(l):$("#"+row_id+"-popup").css("top",position).addClass("opened").slideDown(l)}),$(a).on("click","[data-tool=popup-hide]",function(){$(this).parent().removeClass("opened").slideUp(l)}),$("body").on("click",function(e){$(".buysell_popup").each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$("#buysell").has(e.target).length||$(".buysell_popup").slideUp(l)}),$("#create_order_buy").each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$("#create_order_buy").has(e.target).length||$("#create_order_buy").slideUp(l)}),$("#create_order_sell").each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$("#create_order_sell").has(e.target).length||$("#create_order_sell").slideUp(l)}),$(".offsidebar .profile").each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$(".offsidebar .profile").has(e.target).length||$("body").removeClass("offsidebar-open")}),$(".chooser").each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$(".chooser").has(e.target).length||$(".chooser").removeClass("open")}),$(".notification .dropdown-menu").each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||0!==$(".chooser").has(e.target).length||$(".notification").removeClass("open")})}),$.fn.scrollTo=function(e,a,t){"function"==typeof a&&2==arguments.length&&(t=a,a=e);var n=$.extend({scrollTarget:e,offsetTop:50,duration:500,easing:"swing"},a);return this.each(function(){var e=$(this),a="number"==typeof n.scrollTarget?n.scrollTarget:$(n.scrollTarget),o="number"==typeof a?a:a.offset().top+e.scrollTop()-parseInt(n.offsetTop);e.animate({scrollTop:o},parseInt(n.duration),n.easing,function(){"function"==typeof t&&t.call(this)})})},$(a).on("click","#paymentTop .other",function(){$("#paymentTop .table-responsive").scrollTo(500,{duration:"slow"})}),$(a).on("click","#fav-cross",function(){$(this).parent().find(".favorite-selector").select2("val",""),$(this).fadeOut()}),$(a).on("click",".chooser .icon-down-arrow",function(){$(this).parent().toggleClass("open")}),$(a).on("click",".buysell_popup .closed",function(){$(this).parent().find(".opened").toggleClass("opened").toggleClass("closed"),$(this).toggleClass("opened").toggleClass("closed")}),$(a).on("click",".buysell_popup .opened .close-line",function(){$(this).parent().removeClass("opened").addClass("closed")}),$(".sortable").sortable({forcePlaceholderSize:!0,placeholder:'<div class="box-placeholder p0 m0"><div></div></div>'}),$(a).on("change",".plus select",function(){var e=$(this).val(),a=$(this).val();""!=e&&($(this).find("option[value='"+e+"']").remove(),$(this).select2("val",""),$("#"+$(this).attr("id").replace("-filter","")).append('<li class="list-group-item" value="'+e+'"><em class="icon-dashboard text-muted mr-lg"></em>'+a+'<div class="remove"></div></li>').sortable({forcePlaceholderSize:!0,placeholder:'<div class="box-placeholder p0 m0"><div></div></div>'}).parent().fadeIn(),$("#"+$(this).attr("id").replace("filter","inputs")).append('<div class="'+e+'-field clearfix"><div class="col"><span><span data-localize="trades.popup.LABEL2">Cost in </span> <span> '+a+'</span></span><input class="form-control input-sm" type="text" name="'+e+'-cost"></div><div class="col2 fee"><div data-localize="trades.popup.LABEL_FEE">With fee </div><div><span class="percent">0.26</span> <span>'+a+"</span></div></label></div></div>").find("[data-localize]").localize("site",{pathPrefix:"i18n",language:$.localStorage.get("jq-appLang")})),1==$(this).find("option").length&&$(this).prop("disabled",!0)}),$(a).on("click",".sortable li .remove",function(e){var a=$.trim($(this).parent().text());$("#"+$(this).parent().parent().attr("id")+"-filter").append('<option value="'+a+'">'+a+"</option").select2({minimumResultsForSearch:"Infinity",width:"resolve"}).prop("disabled",!1),$("#"+$(this).parent().parent().attr("id")+"-inputs").find("."+a+"-field").remove();var t="#"+$(this).parent().parent().attr("id");$(this).parent().remove(),0==$(t).find("li").length&&$(t).parent().fadeOut()});var r=.02,c=1+r,p=1-r,d=386.385,u=28770,f=352,h=2776.08,g=5946.503,v=1574,m=44034.6625,b=2499.0917,l=function(){var e=0;return function(a,t){clearTimeout(e),e=setTimeout(a,t)}}();$(a).on("change input keyup mouseup",".inputs input",function(e){switch(this.value=this.value.replace(/[^0-9\.]/g,""),$(this).hasClass("with_fee")?new_value=parseFloat($(this).val()/c):new_value=parseFloat($(this).val()),(""==new_value||new_value<0||"NaN"==new_value)&&(new_value=0),field=$(this).parent().parent(),container=$(this).parent().parent().parent(),currency_changed=field.attr("class").split(" ")[0].replace("-field",""),a=0,currency_changed){case"BTC":var a=new_value;break;case"USD":var a=new_value/d;break;case"RUB":var a=new_value/u;break;case"EUR":var a=new_value/f;break;case"DKK":var a=new_value/h;break;case"ZAR":var a=new_value/g;break;case"RON":var a=new_value/v;break;case"JPY":var a=new_value/m;break;case"CNY":var a=new_value/b;break;default:var a=0}l(function(){$(container).find(".clearfix").each(function(){switch((0>a||""==a)&&(a=0),currency=$(this).attr("class").split(" ")[0].replace("-field",""),round=2,currency){case"BTC":value=a,round=8;break;case"USD":value=a*d,round=3;break;case"RUB":value=a*u,round=2;break;case"EUR":value=a*f,round=3;break;case"DKK":value=a*h,round=2;break;case"ZAR":value=a*g,round=3;break;case"RON":value=a*v,round=2;break;case"JPY":value=a*m,round=4;break;case"CNY":value=a*b,round=4}currency!=currency_changed?($(this).find(".col input").val(n(value,round)),$(this).find(".col2 .percent").text(n(value*r,2)),$(this).find(".col2 input").val(n(value*c,round))):($(this).find(".col input").val(new_value),$(this).find(".col2 .percent").text(n(new_value*r,2)),$(this).find(".col2 input").val(n(new_value*c,round)))})},500)}),$(a).on("click","[data-action=create_order_buy]",function(){return $("#create_order_buy").slideDown().animatescroll(),!1}),$(a).on("click","[data-action=create_order_sell]",function(){return $("#create_order_sell").slideDown().animatescroll(),!1}),$(a).on("click","#create_order_buy .hide_it",function(){$("#create_order_buy").slideUp()}),$(a).on("click","#create_order_sell .hide_it",function(){$("#create_order_sell").slideUp()}),$(a).on("click",".settings-panel .close-settings",function(){$(this).parent().toggle()}),$(a).on("click",".settings .arrow",function(){return $(this).parent().parent().find(".settings-panel").toggle(),!1}),$(a).on("click","#orders .nav li",function(){$(this).parent().parent().find(".favorite-selector, .payment-selector").select2({})}),$("#chk-sound").on("change",function(e){$(this).parent().find("em").toggleClass("active")}),$(a).on("click",".notification .label",function(){$(this).parent().addClass("open")}),$(a).on("click",".notification .icon-cross",function(){$(this).parent().slideUp().remove(),count=$("ul.notifications li").length,$("#notification_label").text(count),0==count&&($("ul.default").fadeIn(),$("ul.notifications").parent().find(".footer .hide_all").hide(),$("ul.notifications").parent().find(".footer .hide_panel").show())}),$(a).on("click",".notification .footer .hide_all",function(){$(this).parent().parent().find("ul.notifications").remove(),$(this).parent().parent().find("ul.default").fadeIn(),$(this).parent().find(".hide_panel").show(),$(this).fadeOut()}),$(a).on("click",".notification .footer .hide_panel",function(){$(this).parent().parent().parent().removeClass("open")}),$("#ordersBuy, #ordersSell").dataTable({paging:!0,searching:!1,lengthChange:!1,bInfo:!1,sDom:"<'row'<'col-xs-6'l><'col-xs-6'f>r>t<'row'p<'show-closed'>>",language:{paginate:{first:"«",previous:"«",next:"»",last:"»"}},pageLength:7,pagingType:"simple_numbers",sAjaxSource:"../server/manage_orders.json",aoColumns:[{sClass:"message",mData:"message"},{mData:"order_name"},{mData:"btc"},{sType:"formatted-num",mData:"amount"},{mData:"status"},{mData:"date"},{sClass:"arrow",bSortable:!1,sDefaultContent:'<span class="icon-down-arrow"></span>',mData:null}],initComplete:function(){this.parent().find(".show-closed").append('<button class="button btn btn-transparent"></button>'),this.parent().find(".show-closed button").attr("data-localize","trades.SHOWCLOSED").localize("site",{pathPrefix:"i18n",language:$.localStorage.get("jq-appLang")})},fnDrawCallback:function(){this.parent().find("[data-localize]").localize("site",{pathPrefix:"i18n",language:$.localStorage.get("jq-appLang")}),$("#paymentTop").matchHeight._update()}}),jQuery.extend(jQuery.fn.dataTableExt.oSort,{"signed-num-pre":function(e){return"-"==e||""===e?0:1*e.replace("+","")},"signed-num-asc":function(e,a){return a>e?-1:e>a?1:0},"signed-num-desc":function(e,a){return a>e?1:e>a?-1:0}}),jQuery.extend(jQuery.fn.dataTableExt.oSort,{"formatted-num-pre":function(e){return e="-"===e||""===e?0:e.replace(/[^\d\-\.]/g,""),parseFloat(e)},"formatted-num-asc":function(e,a){return e-a},"formatted-num-desc":function(e,a){return a-e}}),$("#orders-buy-table, #orders-sell-table").dataTable({paging:!0,searching:!0,lengthChange:!1,bInfo:!1,sDom:"<'row'<'col-xs-6 col-md-6'f><'col-xs-6 col-md-6'<'fav dataTables_filter'>>r><'row'<'col-xs-12'<'currencies'>>>t<'row'p>",language:{paginate:{first:"«",previous:"«",next:"»",last:"»"}},oLanguage:{sSearch:'<i class="icon-magnifier"></i>'},pageLength:14,pagingType:"simple_numbers",sAjaxSource:"../server/orders.json",aoColumns:[{sType:"formatted-num",sClass:"price",mData:"price"},{mData:"amount"},{sClass:"payment",bSortable:!1,mData:"payment"},{sClass:"seller",mData:"seller"},{sType:"signed-num",sClass:"rating",mData:"rating"},{sClass:"buy_button",bSortable:!1,sDefaultContent:'<a href="#" data-localize="trades.BUY" class="btn btn-orange btn-sm"></a>',mData:null}],initComplete:function(){this.parent().find("[type=search]").attr("data-localize","trades.SEARCH").localize("site",{pathPrefix:"i18n",language:$.localStorage.get("jq-appLang")}),this.parent().find(".fav").append('<label class="control-label mb"><i class="icon-favorite"></i><select id="fav-'+this.attr("id")+'" class="favorite-selector form-control" name="favorite" value=""><option class="default" value="" data-localize="trades.FAVORITE"></option><option value="Константин Константинопольский">Константин Константинопольский</option><option value="Александридис Константинопулос">Александридис Константинопулос</option><option value="Валерий Панфилов">Валерий Панфилов</option><option value="Александр Валерьев">Александр Валерьев</option></select><i id="fav-cross" class="icon-cross" style="display:none"></label>');var e="fav-"+this.attr("id");this.parent().find(".currencies").append('<a href="#" class="active">RUB</a><a href="#">USD</a><a href="#">EUR</a>'),this.api().columns(".payment").every(function(){var e=this,a=$('<select class="payment-selector form-control"><option data-localize="trades.PAYMENTSYSTEM" value=""></option></select>').appendTo($(e.header()).empty()).on("change",function(){var a=$.fn.dataTable.util.escapeRegex($(this).val());e.search(a?"^"+a+"$":"",!0,!1).draw()});e.data().unique().sort().each(function(e,t){a.append('<option value="'+e+'">'+e+"</option>")}),a.wrap("<div class='select-wrapper'></div>").find("[data-localize]").localize("site",{pathPrefix:"i18n",language:$.localStorage.get("jq-appLang")})}),this.parent().find(".fav, .buy_button").find("[data-localize]").localize("site",{pathPrefix:"i18n",language:$.localStorage.get("jq-appLang")}),$(".favorite-selector").select2({}),$(".payment-selector").select2({}),this.api().column(".seller").every(function(){var a="",t=this,n=$("#"+e).on("click",function(){$("#select2-"+e+"-results li:first").text("Отменить")}).on("change",function(){a=$.fn.dataTable.util.escapeRegex($(this).val()),t.search(a?"^"+a+"$":"",!0,!1).draw(),""==a?$("#"+e).parent().find(".select2-selection__rendered").css("color","#B8BBCA"):($("#fav-cross").fadeIn(),$("#"+e).parent().find(".select2-selection__rendered").css("color","#000"))})}),$("#paymentTop").matchHeight({byRow:!0,property:"height",target:$("#buysell"),remove:!1})},fnDrawCallback:function(){this.parent().find(".buy_button").find("[data-localize]").localize("site",{pathPrefix:"i18n",language:$.localStorage.get("jq-appLang")})}})})}(window,document,window.jQuery);